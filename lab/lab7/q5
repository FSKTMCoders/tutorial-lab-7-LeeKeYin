import java.io.*;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;

class Person implements Serializable {
    String name;
    int age;
    char gender;
    
    public Person(String name, int age, char gender) {
        this.name = name;
        this.age = age;
        this.gender = gender;
    }
    
    @Override
    public String toString() {
        String genderStr = (gender == 'M' || gender == 'm') ? "Male" : "Female";
        return String.format("Name: %-20s Age: %-5d Gender: %s", name, age, genderStr);
    }
}

public class Lab7Q5 {
    public static void main(String[] args) {

        createSamplePersonFile();

        readAndDisplaySortedPersons();
    }
    
    private static void createSamplePersonFile() {
        ArrayList<Person> persons = new ArrayList<>();
        persons.add(new Person("Alice Johnson", 25, 'F'));
        persons.add(new Person("Bob Smith", 30, 'M'));
        persons.add(new Person("Charlie Brown", 22, 'M'));
        persons.add(new Person("Diana Prince", 28, 'F'));
        persons.add(new Person("Edward Wong", 35, 'M'));
        
        try (ObjectOutputStream oos = new ObjectOutputStream(
                new FileOutputStream("person.dat"))) {
            oos.writeInt(persons.size()); 
            for (Person p : persons) {
                oos.writeObject(p);
            }
            System.out.println("Sample person.dat created with " + persons.size() + " records");
        } catch (IOException e) {
            System.out.println("Error creating file: " + e.getMessage());
        }
    }
    
    private static void readAndDisplaySortedPersons() {
        try (ObjectInputStream ois = new ObjectInputStream(
                new FileInputStream("person.dat"))) {
            
            int totalRecords = ois.readInt();
            ArrayList<Person> persons = new ArrayList<>();
            
            for (int i = 0; i < totalRecords; i++) {
                Person p = (Person) ois.readObject();
                persons.add(p);
            }

            Collections.sort(persons, new Comparator<Person>() {
                @Override
                public int compare(Person p1, Person p2) {
                    return p1.name.compareToIgnoreCase(p2.name);
                }
            });

            System.out.println("\nPerson Data (Sorted by Name):");
            System.out.println("=".repeat(50));
            for (Person p : persons) {
                System.out.println(p);
            }
            System.out.println("=".repeat(50));
            System.out.println("Total records: " + persons.size());
            
        } catch (IOException | ClassNotFoundException e) {
            System.out.println("Error reading file: " + e.getMessage());
        }
    }
}
